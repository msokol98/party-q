{"ast":null,"code":"var _jsxFileName = \"/home/mitchell/Projects/party-q/web/src/App.js\";\nimport React, { Component } from 'react';\nimport { BrowserRouter as Router, Switch, Route } from 'react-router-dom';\nimport './App.css';\nimport 'bulma/css/bulma.css';\nimport Navbar from 'components/navbar';\nimport Landing from 'components/landing';\nimport Party from 'components/party/PartyContainer';\nimport { apiHost } from 'config';\nimport queryString from 'query-string';\nimport axios from 'axios';\nimport ProtectedRoute from 'hoc/ProtectedRoute';\n\nclass App extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      token: queryString.parse(window.location.search).access_token,\n      user: JSON.parse(localStorage.getItem('user'))\n    };\n\n    this.fetchUser = () => {\n      const {\n        token,\n        user\n      } = this.state;\n      !user && token && axios.get('https://api.spotify.com/v1/me', {\n        headers: {\n          'Authorization': 'Bearer ' + token\n        }\n      }).then(response => this.storeUser(response.data));\n    };\n\n    this.storeUser = user => {\n      const {\n        token\n      } = this.state;\n      axios.post(`${apiHost}/api/members`, {\n        name: user.display_name,\n        email: user.email,\n        token: token\n      }).then(response => {\n        const theUser = response.data;\n        this.setState({\n          user: theUser\n        });\n        localStorage.setItem('user', JSON.stringify(theUser));\n      });\n    };\n\n    this.logout = () => {\n      localStorage.removeItem('user');\n    };\n  }\n\n  componentDidMount() {\n    this.fetchUser();\n  }\n\n  render() {\n    const {\n      user\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"App has-text-light has-background-dark\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Navbar, {\n      user: user,\n      logout: this.logout,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        minHeight: 'calc(100vh - 70px)'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Router, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Switch, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Route, {\n      exact: true,\n      path: \"/\",\n      component: Landing,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(ProtectedRoute, {\n      user: user,\n      exact: true,\n      path: \"/party\",\n      component: Party,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 17\n      }\n    })))));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/home/mitchell/Projects/party-q/web/src/App.js"],"names":["React","Component","BrowserRouter","Router","Switch","Route","Navbar","Landing","Party","apiHost","queryString","axios","ProtectedRoute","App","state","token","parse","window","location","search","access_token","user","JSON","localStorage","getItem","fetchUser","get","headers","then","response","storeUser","data","post","name","display_name","email","theUser","setState","setItem","stringify","logout","removeItem","componentDidMount","render","minHeight"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { BrowserRouter as Router, Switch, Route } from 'react-router-dom';\n\nimport './App.css';\nimport 'bulma/css/bulma.css'\n\nimport Navbar from 'components/navbar';\nimport Landing from 'components/landing';\nimport Party from 'components/party/PartyContainer';\n\nimport { apiHost } from 'config';\nimport queryString from 'query-string';\nimport axios from 'axios';\nimport ProtectedRoute from 'hoc/ProtectedRoute';\n\nclass App extends Component {\n\n  state = {\n    token: queryString.parse(window.location.search).access_token,\n    user: JSON.parse(localStorage.getItem('user'))\n  }\n\n  fetchUser = () => {\n    const { token, user } = this.state;\n\n    !user && token && axios.get('https://api.spotify.com/v1/me',\n          { headers: { 'Authorization': 'Bearer ' + token} }\n      ).then(response => this.storeUser(response.data))\n  }\n\n  storeUser = user => {\n    const { token } = this.state;\n \n    axios.post(`${apiHost}/api/members`, {\n      name: user.display_name, email: user.email, token: token\n    })\n      .then(response => {\n        const theUser = response.data;\n        this.setState({user: theUser});\n        localStorage.setItem('user', JSON.stringify(theUser)) \n      })\n  }\n\n  componentDidMount() {\n    this.fetchUser();\n  }\n\n  logout = () => {\n    localStorage.removeItem('user');\n  }\n  \n  render() {\n    const { user } = this.state;\n    return (\n      <div className=\"App has-text-light has-background-dark\">\n\n        <Navbar user={user} logout={this.logout} />\n\n        <div style={{minHeight: 'calc(100vh - 70px)'}}>\n            <Router>\n              <Switch>\n                <Route exact={true} path='/' component={Landing} />\n                <ProtectedRoute user={user} exact={true} path='/party' component={Party} />\n              </Switch>\n            </Router>\n          </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}