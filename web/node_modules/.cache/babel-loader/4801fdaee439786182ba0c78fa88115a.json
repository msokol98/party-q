{"ast":null,"code":"import _classCallCheck from\"/home/mitchell/Projects/party-q/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/mitchell/Projects/party-q/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/mitchell/Projects/party-q/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/mitchell/Projects/party-q/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{BrowserRouter as Router,Switch,Route}from'react-router-dom';import'./App.css';import'bulma/css/bulma.css';import Navbar from'components/navbar';import Landing from'components/landing';import Party from'components/party/PartyContainer';import{apiHost}from'config';import queryString from'query-string';import axios from'axios';import ProtectedRoute from'hoc/ProtectedRoute';var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);var _super=_createSuper(App);function App(){var _this;_classCallCheck(this,App);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={token:queryString.parse(window.location.search).access_token,user:JSON.parse(localStorage.getItem('user'))};_this.fetchUser=function(){var _this$state=_this.state,token=_this$state.token,user=_this$state.user;!user&&token&&axios.get('https://api.spotify.com/v1/me',{headers:{'Authorization':'Bearer '+token}}).then(function(response){return _this.storeUser(response.data);});};_this.storeUser=function(user){var token=_this.state.token;axios.post(\"\".concat(apiHost,\"/api/members\"),{name:user.display_name,email:user.email,token:token}).then(function(response){var theUser=response.data;_this.setState({user:theUser});localStorage.setItem('user',JSON.stringify(theUser));});};_this.logout=function(){localStorage.removeItem('user');_this.setState({user:null});};return _this;}_createClass(App,[{key:\"componentDidMount\",value:function componentDidMount(){this.fetchUser();}},{key:\"render\",value:function render(){var user=this.state.user;return/*#__PURE__*/React.createElement(\"div\",{className:\"App has-text-light has-background-dark\"},/*#__PURE__*/React.createElement(Navbar,{user:user,logout:this.logout}),/*#__PURE__*/React.createElement(\"div\",{style:{minHeight:'calc(100vh - 70px)'}},/*#__PURE__*/React.createElement(Router,null,/*#__PURE__*/React.createElement(Switch,null,/*#__PURE__*/React.createElement(Route,{exact:true,path:\"/\",component:Landing}),/*#__PURE__*/React.createElement(ProtectedRoute,{user:user,exact:true,path:\"/party\",component:Party})))));}}]);return App;}(Component);export default App;","map":{"version":3,"sources":["/home/mitchell/Projects/party-q/web/src/App.js"],"names":["React","Component","BrowserRouter","Router","Switch","Route","Navbar","Landing","Party","apiHost","queryString","axios","ProtectedRoute","App","state","token","parse","window","location","search","access_token","user","JSON","localStorage","getItem","fetchUser","get","headers","then","response","storeUser","data","post","name","display_name","email","theUser","setState","setItem","stringify","logout","removeItem","minHeight"],"mappings":"wlBAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OAASC,aAAa,GAAIC,CAAAA,MAA1B,CAAkCC,MAAlC,CAA0CC,KAA1C,KAAuD,kBAAvD,CAEA,MAAO,WAAP,CACA,MAAO,qBAAP,CAEA,MAAOC,CAAAA,MAAP,KAAmB,mBAAnB,CACA,MAAOC,CAAAA,OAAP,KAAoB,oBAApB,CACA,MAAOC,CAAAA,KAAP,KAAkB,iCAAlB,CAEA,OAASC,OAAT,KAAwB,QAAxB,CACA,MAAOC,CAAAA,WAAP,KAAwB,cAAxB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,cAAP,KAA2B,oBAA3B,C,GAEMC,CAAAA,G,+SAEJC,K,CAAQ,CACNC,KAAK,CAAEL,WAAW,CAACM,KAAZ,CAAkBC,MAAM,CAACC,QAAP,CAAgBC,MAAlC,EAA0CC,YAD3C,CAENC,IAAI,CAAEC,IAAI,CAACN,KAAL,CAAWO,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,CAFA,C,OAKRC,S,CAAY,UAAM,iBACQ,MAAKX,KADb,CACRC,KADQ,aACRA,KADQ,CACDM,IADC,aACDA,IADC,CAGhB,CAACA,IAAD,EAASN,KAAT,EAAkBJ,KAAK,CAACe,GAAN,CAAU,+BAAV,CACZ,CAAEC,OAAO,CAAE,CAAE,gBAAiB,UAAYZ,KAA/B,CAAX,CADY,EAEda,IAFc,CAET,SAAAC,QAAQ,QAAI,OAAKC,SAAL,CAAeD,QAAQ,CAACE,IAAxB,CAAJ,EAFC,CAAlB,CAGD,C,OAEDD,S,CAAY,SAAAT,IAAI,CAAI,IACVN,CAAAA,KADU,CACA,MAAKD,KADL,CACVC,KADU,CAGlBJ,KAAK,CAACqB,IAAN,WAAcvB,OAAd,iBAAqC,CACnCwB,IAAI,CAAEZ,IAAI,CAACa,YADwB,CACVC,KAAK,CAAEd,IAAI,CAACc,KADF,CACSpB,KAAK,CAAEA,KADhB,CAArC,EAGGa,IAHH,CAGQ,SAAAC,QAAQ,CAAI,CAChB,GAAMO,CAAAA,OAAO,CAAGP,QAAQ,CAACE,IAAzB,CACA,MAAKM,QAAL,CAAc,CAAChB,IAAI,CAAEe,OAAP,CAAd,EACAb,YAAY,CAACe,OAAb,CAAqB,MAArB,CAA6BhB,IAAI,CAACiB,SAAL,CAAeH,OAAf,CAA7B,EACD,CAPH,EAQD,C,OAMDI,M,CAAS,UAAM,CACbjB,YAAY,CAACkB,UAAb,CAAwB,MAAxB,EACA,MAAKJ,QAAL,CAAc,CAAChB,IAAI,CAAE,IAAP,CAAd,EACD,C,4FAPmB,CAClB,KAAKI,SAAL,GACD,C,uCAOQ,IACCJ,CAAAA,IADD,CACU,KAAKP,KADf,CACCO,IADD,CAEP,mBACE,2BAAK,SAAS,CAAC,wCAAf,eAEE,oBAAC,MAAD,EAAQ,IAAI,CAAEA,IAAd,CAAoB,MAAM,CAAE,KAAKmB,MAAjC,EAFF,cAIE,2BAAK,KAAK,CAAE,CAACE,SAAS,CAAE,oBAAZ,CAAZ,eACI,oBAAC,MAAD,mBACE,oBAAC,MAAD,mBACE,oBAAC,KAAD,EAAO,KAAK,CAAE,IAAd,CAAoB,IAAI,CAAC,GAAzB,CAA6B,SAAS,CAAEnC,OAAxC,EADF,cAEE,oBAAC,cAAD,EAAgB,IAAI,CAAEc,IAAtB,CAA4B,KAAK,CAAE,IAAnC,CAAyC,IAAI,CAAC,QAA9C,CAAuD,SAAS,CAAEb,KAAlE,EAFF,CADF,CADJ,CAJF,CADF,CAeD,C,iBAtDeP,S,EAyDlB,cAAeY,CAAAA,GAAf","sourcesContent":["import React, { Component } from 'react';\nimport { BrowserRouter as Router, Switch, Route } from 'react-router-dom';\n\nimport './App.css';\nimport 'bulma/css/bulma.css'\n\nimport Navbar from 'components/navbar';\nimport Landing from 'components/landing';\nimport Party from 'components/party/PartyContainer';\n\nimport { apiHost } from 'config';\nimport queryString from 'query-string';\nimport axios from 'axios';\nimport ProtectedRoute from 'hoc/ProtectedRoute';\n\nclass App extends Component {\n\n  state = {\n    token: queryString.parse(window.location.search).access_token,\n    user: JSON.parse(localStorage.getItem('user'))\n  }\n\n  fetchUser = () => {\n    const { token, user } = this.state;\n\n    !user && token && axios.get('https://api.spotify.com/v1/me',\n          { headers: { 'Authorization': 'Bearer ' + token} }\n      ).then(response => this.storeUser(response.data))\n  }\n\n  storeUser = user => {\n    const { token } = this.state;\n \n    axios.post(`${apiHost}/api/members`, {\n      name: user.display_name, email: user.email, token: token\n    })\n      .then(response => {\n        const theUser = response.data;\n        this.setState({user: theUser});\n        localStorage.setItem('user', JSON.stringify(theUser)) \n      })\n  }\n\n  componentDidMount() {\n    this.fetchUser();\n  }\n\n  logout = () => {\n    localStorage.removeItem('user');\n    this.setState({user: null})\n  }\n  \n  render() {\n    const { user } = this.state;\n    return (\n      <div className=\"App has-text-light has-background-dark\">\n\n        <Navbar user={user} logout={this.logout} />\n\n        <div style={{minHeight: 'calc(100vh - 70px)'}}>\n            <Router>\n              <Switch>\n                <Route exact={true} path='/' component={Landing} />\n                <ProtectedRoute user={user} exact={true} path='/party' component={Party} />\n              </Switch>\n            </Router>\n          </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}