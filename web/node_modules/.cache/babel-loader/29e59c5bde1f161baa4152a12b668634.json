{"ast":null,"code":"var _jsxFileName = \"/home/mitchell/Projects/party-q/web/src/App.js\";\nimport React, { Component } from 'react';\nimport { BrowserRouter as Router, Switch, Route } from 'react-router-dom';\nimport './App.css';\nimport 'bulma/css/bulma.css';\nimport Navbar from 'components/navbar';\nimport Landing from 'components/landing';\nimport Party from 'components/party/PartyContainer';\nimport { apiHost } from 'config';\nimport queryString from 'query-string';\nimport axios from 'axios';\nimport ProtectedRoute from 'hoc/ProtectedRoute';\nimport { render } from '@testing-library/react';\n\nclass App extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      token: queryString.parse(window.location.search).access_token,\n      user: JSON.parse(localStorage.getItem('user'))\n    };\n\n    this.fetchUser = () => {\n      const {\n        token,\n        user\n      } = this.state;\n      !user && token && axios.get('https://api.spotify.com/v1/me', {\n        headers: {\n          'Authorization': 'Bearer ' + token\n        }\n      }).then(response => this.storeUser(response.data));\n    };\n\n    this.storeUser = user => {\n      const {\n        token\n      } = this.state;\n      axios.post(`${apiHost}/api/members`, {\n        name: user.display_name,\n        email: user.email,\n        token: token\n      }).then(response => {\n        const theUser = response.data;\n        this.setState({\n          user: theUser\n        });\n        localStorage.setItem('user', JSON.stringify(theUser));\n      });\n    };\n  }\n\n  updateWindowDimensions() {\n    this.setState({\n      isMobile: window.innerWidth < 768\n    });\n  }\n\n  componentDidMount() {\n    this.updateWindowDimensions();\n    window.addEventListener('resize', this.updateWindowDimensions);\n    this.fetchUser();\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.updateWindowDimensions);\n  }\n\n  render() {\n    const {\n      isMobile\n    } = true;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"App\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Navbar, {\n      user: user,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"has-background-light\",\n      style: {\n        minHeight: 'calc(100vh - 70px)'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Router, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Switch, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Route, {\n      exact: true,\n      path: \"/\",\n      component: Landing,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(ProtectedRoute, {\n      user: user,\n      exact: true,\n      isMobile: isMobile,\n      path: \"/party\",\n      component: Party,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 17\n      }\n    })))));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/home/mitchell/Projects/party-q/web/src/App.js"],"names":["React","Component","BrowserRouter","Router","Switch","Route","Navbar","Landing","Party","apiHost","queryString","axios","ProtectedRoute","render","App","state","token","parse","window","location","search","access_token","user","JSON","localStorage","getItem","fetchUser","get","headers","then","response","storeUser","data","post","name","display_name","email","theUser","setState","setItem","stringify","updateWindowDimensions","isMobile","innerWidth","componentDidMount","addEventListener","componentWillUnmount","removeEventListener","minHeight"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { BrowserRouter as Router, Switch, Route } from 'react-router-dom';\n\nimport './App.css';\nimport 'bulma/css/bulma.css'\n\nimport Navbar from 'components/navbar';\nimport Landing from 'components/landing';\nimport Party from 'components/party/PartyContainer';\n\nimport { apiHost } from 'config';\nimport queryString from 'query-string';\nimport axios from 'axios';\nimport ProtectedRoute from 'hoc/ProtectedRoute';\nimport { render } from '@testing-library/react';\n\nclass App extends Component {\n\n  state = {\n    token: queryString.parse(window.location.search).access_token,\n    user: JSON.parse(localStorage.getItem('user'))\n  }\n\n  fetchUser = () => {\n    const { token, user } = this.state;\n\n    !user && token && axios.get('https://api.spotify.com/v1/me',\n          { headers: { 'Authorization': 'Bearer ' + token} }\n      ).then(response => this.storeUser(response.data))\n  }\n\n  storeUser = user => {\n    const { token } = this.state;\n \n    axios.post(`${apiHost}/api/members`, {\n      name: user.display_name, email: user.email, token: token\n    })\n      .then(response => {\n        const theUser = response.data;\n        this.setState({user: theUser});\n        localStorage.setItem('user', JSON.stringify(theUser)) \n      })\n  }\n\n  updateWindowDimensions() {\n      this.setState({ isMobile: window.innerWidth < 768});\n  }\n\n  componentDidMount() {\n    this.updateWindowDimensions();\n    window.addEventListener('resize', this.updateWindowDimensions);\n    this.fetchUser();\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.updateWindowDimensions);\n  }\n  \n  render() {\n    const { isMobile } = true;\n    return (\n      <div className=\"App\">\n\n        <Navbar user={user} />\n\n        <div className='has-background-light' style={{minHeight: 'calc(100vh - 70px)'}}>\n            <Router>\n              <Switch>\n                <Route exact={true} path='/' component={Landing} />\n                <ProtectedRoute user={user} exact={true} isMobile={isMobile} path='/party' component={Party} />\n              </Switch>\n            </Router>\n          </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}