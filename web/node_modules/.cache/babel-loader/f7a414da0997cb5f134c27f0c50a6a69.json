{"ast":null,"code":"import _objectSpread from\"/home/mitchell/Projects/party-q/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/home/mitchell/Projects/party-q/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/mitchell/Projects/party-q/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/mitchell/Projects/party-q/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/mitchell/Projects/party-q/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import AddSong from'./AddSong';import axios from'axios';import{apiHost}from'config';import useFormatSong from'hooks/useFormatSong';var AddSongContainer=/*#__PURE__*/function(_Component){_inherits(AddSongContainer,_Component);var _super=_createSuper(AddSongContainer);function AddSongContainer(){var _this;_classCallCheck(this,AddSongContainer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={results:[],addedSong:false};_this.getResults=function(query){var member=_this.props.member;if(query===\"\"){_this.setState({results:[]});return;}axios.get(\"https://api.spotify.com/v1/search\",{headers:{'Authorization':'Bearer '+member.token},params:{q:query,type:\"track,album,artist\",market:\"US\",limit:5}}).then(function(response){return _this.setState({results:response.data.tracks.items});});};_this.addSong=function(song){_this.setState({addedSong:true});var _this$props=_this.props,partyId=_this$props.partyId,hostToken=_this$props.hostToken,member=_this$props.member;_this.addSongToHostPlaylist(song,hostToken);_this.addSongToServerQueue(song,partyId,member.name);};_this.addSongToHostPlaylist=function(song,hostToken){axios.post(\"https://api.spotify.com/v1/me/player/queue\",{},{headers:{'Authorization':'Bearer '+hostToken},params:{uri:song.uri}});};_this.addSongToServerQueue=function(song,partyId,picker){var obj=_objectSpread({picker:picker},useFormatSong(song));console.log(obj);axios.post(\"\".concat(apiHost,\"/api/songs/add?partyId=\").concat(partyId),obj);};return _this;}_createClass(AddSongContainer,[{key:\"render\",value:function render(){var _this$state=this.state,addedSong=_this$state.addedSong,results=_this$state.results;if(addedSong)this.props.resetTab();return/*#__PURE__*/React.createElement(\"div\",{className:\"add-song-wrapper\"},/*#__PURE__*/React.createElement(AddSong,{addSong:this.addSong,results:results,getResults:this.getResults}));}}]);return AddSongContainer;}(Component);export default AddSongContainer;","map":{"version":3,"sources":["/home/mitchell/Projects/party-q/web/src/components/party/active/mobile/tabs/AddSong/AddSongContainer.js"],"names":["React","Component","AddSong","axios","apiHost","useFormatSong","AddSongContainer","state","results","addedSong","getResults","query","member","props","setState","get","headers","token","params","q","type","market","limit","then","response","data","tracks","items","addSong","song","partyId","hostToken","addSongToHostPlaylist","addSongToServerQueue","name","post","uri","picker","obj","console","log","resetTab"],"mappings":"ivBAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,MAAOC,CAAAA,OAAP,KAAoB,WAApB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,OAAT,KAAwB,QAAxB,CACA,MAAOC,CAAAA,aAAP,KAA0B,qBAA1B,C,GAEMC,CAAAA,gB,mWAEFC,K,CAAQ,CAACC,OAAO,CAAE,EAAV,CAAcC,SAAS,CAAE,KAAzB,C,OAERC,U,CAAa,SAAAC,KAAK,CAAI,IACVC,CAAAA,MADU,CACC,MAAKC,KADN,CACVD,MADU,CAGlB,GAAGD,KAAK,GAAK,EAAb,CAAiB,CACb,MAAKG,QAAL,CAAc,CAACN,OAAO,CAAE,EAAV,CAAd,EACA,OACH,CAEDL,KAAK,CAACY,GAAN,CAAU,mCAAV,CAA+C,CAC3CC,OAAO,CAAE,CACL,gBAAiB,UAAYJ,MAAM,CAACK,KAD/B,CADkC,CAI3CC,MAAM,CAAE,CACJC,CAAC,CAAER,KADC,CAEJS,IAAI,CAAE,oBAFF,CAGJC,MAAM,CAAE,IAHJ,CAIJC,KAAK,CAAE,CAJH,CAJmC,CAA/C,EAUGC,IAVH,CAUQ,SAAAC,QAAQ,QAAI,OAAKV,QAAL,CAAc,CAACN,OAAO,CAAEgB,QAAQ,CAACC,IAAT,CAAcC,MAAd,CAAqBC,KAA/B,CAAd,CAAJ,EAVhB,EAYH,C,OAEDC,O,CAAU,SAAAC,IAAI,CAAI,CACd,MAAKf,QAAL,CAAc,CAACL,SAAS,CAAE,IAAZ,CAAd,EADc,gBAGyB,MAAKI,KAH9B,CAGNiB,OAHM,aAGNA,OAHM,CAGGC,SAHH,aAGGA,SAHH,CAGcnB,MAHd,aAGcA,MAHd,CAId,MAAKoB,qBAAL,CAA2BH,IAA3B,CAAiCE,SAAjC,EACA,MAAKE,oBAAL,CAA0BJ,IAA1B,CAAgCC,OAAhC,CAAyClB,MAAM,CAACsB,IAAhD,EACH,C,OAEDF,qB,CAAwB,SAACH,IAAD,CAAOE,SAAP,CAAqB,CACzC5B,KAAK,CAACgC,IAAN,CAAW,4CAAX,CAAyD,EAAzD,CAA6D,CACzDnB,OAAO,CAAE,CACL,gBAAiB,UAAYe,SADxB,CADgD,CAIzDb,MAAM,CAAE,CACJkB,GAAG,CAAEP,IAAI,CAACO,GADN,CAJiD,CAA7D,EAQH,C,OAEDH,oB,CAAuB,SAACJ,IAAD,CAAOC,OAAP,CAAgBO,MAAhB,CAA2B,CAC9C,GAAMC,CAAAA,GAAG,gBAAID,MAAM,CAANA,MAAJ,EAAehC,aAAa,CAACwB,IAAD,CAA5B,CAAT,CACAU,OAAO,CAACC,GAAR,CAAYF,GAAZ,EACAnC,KAAK,CAACgC,IAAN,WAAc/B,OAAd,mCAA+C0B,OAA/C,EAA0DQ,GAA1D,EACH,C,mFAEQ,iBAC0B,KAAK/B,KAD/B,CACGE,SADH,aACGA,SADH,CACcD,OADd,aACcA,OADd,CAGL,GAAGC,SAAH,CAAc,KAAKI,KAAL,CAAW4B,QAAX,GAGd,mBACI,2BAAK,SAAS,CAAC,kBAAf,eACI,oBAAC,OAAD,EAAS,OAAO,CAAE,KAAKb,OAAvB,CAAgC,OAAO,CAAEpB,OAAzC,CAAkD,UAAU,CAAE,KAAKE,UAAnE,EADJ,CADJ,CAKH,C,8BA9D0BT,S,EAiE/B,cAAeK,CAAAA,gBAAf","sourcesContent":["import React, { Component } from 'react';\nimport AddSong from './AddSong';\nimport axios from 'axios';\nimport { apiHost } from 'config';\nimport useFormatSong from 'hooks/useFormatSong';\n\nclass AddSongContainer extends Component {\n\n    state = {results: [], addedSong: false}\n\n    getResults = query => {\n        const { member } = this.props;\n\n        if(query === \"\") {\n            this.setState({results: []});\n            return;\n        }\n\n        axios.get(\"https://api.spotify.com/v1/search\", {\n            headers: {\n                'Authorization': 'Bearer ' + member.token\n            }, \n            params: {\n                q: query,\n                type: \"track,album,artist\",\n                market: \"US\",\n                limit: 5\n            }\n        }).then(response => this.setState({results: response.data.tracks.items}))\n\n    }\n\n    addSong = song => {\n        this.setState({addedSong: true});\n\n        const { partyId, hostToken, member } = this.props;\n        this.addSongToHostPlaylist(song, hostToken);\n        this.addSongToServerQueue(song, partyId, member.name);\n    }\n\n    addSongToHostPlaylist = (song, hostToken) => {\n        axios.post(\"https://api.spotify.com/v1/me/player/queue\", {}, {\n            headers: {\n                'Authorization': 'Bearer ' + hostToken\n            }, \n            params: {\n                uri: song.uri\n            }\n        });\n    }\n\n    addSongToServerQueue = (song, partyId, picker) => { \n        const obj = {picker, ...useFormatSong(song)};\n        console.log(obj);\n        axios.post(`${apiHost}/api/songs/add?partyId=${partyId}`, obj);\n    }\n\n    render() {\n        const { addedSong, results } = this.state;\n\n        if(addedSong) this.props.resetTab(); \n        \n\n        return(\n            <div className=\"add-song-wrapper\">\n                <AddSong addSong={this.addSong} results={results} getResults={this.getResults} />\n            </div>\n        )\n    }\n}\n \nexport default AddSongContainer;"]},"metadata":{},"sourceType":"module"}