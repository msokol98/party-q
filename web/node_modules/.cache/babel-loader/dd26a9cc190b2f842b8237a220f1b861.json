{"ast":null,"code":"var _jsxFileName = \"/home/mitchell/Projects/party-q/web/src/components/party/active/PartyContainer.js\";\nimport React, { Component } from 'react';\nimport Mobile from './mobile';\nimport axios from 'axios';\nimport { apiHost } from 'config';\n\nclass PartyContainer extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      currentSong: null\n    };\n\n    this.getCurrentSong = () => {\n      if (!party || !party.host) return;\n      const token = party.host.token;\n      axios.get(\"https://api.spotify.com/v1/me/player/currently-playing\", {\n        headers: {\n          'Authorization': 'Bearer ' + token\n        }\n      }).then(response => {\n        const song = response.data.item;\n        if (!song) return;\n        if (currentSong && song) console.log(currentSong.id === song.id);\n        song && (!currentSong || song.id !== currentSong.id) && changeCurrentSong(song);\n      });\n    };\n\n    this.changeCurrentSong = song => {\n      localStorage.setItem('song', JSON.stringify(song));\n      setCS(song);\n      axios.post(`${apiHost}/api/songs/current?partyId=${party.id}`, {\n        artist: song.artists && song.artists[0] && song.artists[0].name,\n        imageURI: song.album && song.album.images && song.album.images[0] && song.album.images[0].url.song && song.name\n      });\n    };\n  }\n\n  componentDidMount() {\n    if (member.id !== party.host.id) return;\n    setInterval(getCurrentSong, 2000);\n  }\n\n  render() {\n    const {\n      currentSong\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Mobile, {\n      party: { ...party,\n        currentSong\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 17\n      }\n    }));\n  }\n\n}\n\nexport default PartyContainer;","map":{"version":3,"sources":["/home/mitchell/Projects/party-q/web/src/components/party/active/PartyContainer.js"],"names":["React","Component","Mobile","axios","apiHost","PartyContainer","state","currentSong","getCurrentSong","party","host","token","get","headers","then","response","song","data","item","console","log","id","changeCurrentSong","localStorage","setItem","JSON","stringify","setCS","post","artist","artists","name","imageURI","album","images","url","componentDidMount","member","setInterval","render"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,MAAP,MAAmB,UAAnB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,OAAT,QAAwB,QAAxB;;AAEA,MAAMC,cAAN,SAA6BJ,SAA7B,CAAuC;AAAA;AAAA;AAAA,SAEnCK,KAFmC,GAE3B;AAACC,MAAAA,WAAW,EAAE;AAAd,KAF2B;;AAAA,SAInCC,cAJmC,GAIlB,MAAM;AACnB,UAAG,CAACC,KAAD,IAAU,CAACA,KAAK,CAACC,IAApB,EAA0B;AAE1B,YAAMC,KAAK,GAAGF,KAAK,CAACC,IAAN,CAAWC,KAAzB;AACAR,MAAAA,KAAK,CAACS,GAAN,CAAU,wDAAV,EAAoE;AAChEC,QAAAA,OAAO,EAAE;AACL,2BAAiB,YAAYF;AADxB;AADuD,OAApE,EAIGG,IAJH,CAIQC,QAAQ,IAAI;AAChB,cAAMC,IAAI,GAAGD,QAAQ,CAACE,IAAT,CAAcC,IAA3B;AAEA,YAAG,CAACF,IAAJ,EAAU;AAEV,YAAGT,WAAW,IAAIS,IAAlB,EAAwBG,OAAO,CAACC,GAAR,CAAYb,WAAW,CAACc,EAAZ,KAAmBL,IAAI,CAACK,EAApC;AAExBL,QAAAA,IAAI,KAAK,CAACT,WAAD,IAAgBS,IAAI,CAACK,EAAL,KAAYd,WAAW,CAACc,EAA7C,CAAJ,IAAwDC,iBAAiB,CAACN,IAAD,CAAzE;AACH,OAZD;AAaH,KArBkC;;AAAA,SAuBnCM,iBAvBmC,GAuBfN,IAAI,IAAI;AACxBO,MAAAA,YAAY,CAACC,OAAb,CAAqB,MAArB,EAA6BC,IAAI,CAACC,SAAL,CAAeV,IAAf,CAA7B;AACAW,MAAAA,KAAK,CAACX,IAAD,CAAL;AAEAb,MAAAA,KAAK,CAACyB,IAAN,CAAY,GAAExB,OAAQ,8BAA6BK,KAAK,CAACY,EAAG,EAA5D,EAA+D;AAC3DQ,QAAAA,MAAM,EAAEb,IAAI,CAACc,OAAL,IAAgBd,IAAI,CAACc,OAAL,CAAa,CAAb,CAAhB,IAAmCd,IAAI,CAACc,OAAL,CAAa,CAAb,EAAgBC,IADA;AAE3DC,QAAAA,QAAQ,EAAEhB,IAAI,CAACiB,KAAL,IAAcjB,IAAI,CAACiB,KAAL,CAAWC,MAAzB,IAAmClB,IAAI,CAACiB,KAAL,CAAWC,MAAX,CAAkB,CAAlB,CAAnC,IAA2DlB,IAAI,CAACiB,KAAL,CAAWC,MAAX,CAAkB,CAAlB,EAAqBC,GAArB,CACrEnB,IADU,IACFA,IAAI,CAACe;AAH8C,OAA/D;AAKH,KAhCkC;AAAA;;AAkCnCK,EAAAA,iBAAiB,GAAG;AAChB,QAAGC,MAAM,CAAChB,EAAP,KAAcZ,KAAK,CAACC,IAAN,CAAWW,EAA5B,EAAgC;AAChCiB,IAAAA,WAAW,CAAC9B,cAAD,EAAiB,IAAjB,CAAX;AACH;;AAED+B,EAAAA,MAAM,GAAG;AACL,UAAM;AAAEhC,MAAAA;AAAF,QAAkB,KAAKD,KAA7B;AACA,wBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI,oBAAC,MAAD;AAAQ,MAAA,KAAK,EAAE,EAAC,GAAGG,KAAJ;AAAWF,QAAAA;AAAX,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,CADJ;AAKH;;AA9CkC;;AAiDvC,eAAeF,cAAf","sourcesContent":["import React, { Component } from 'react';\nimport Mobile from './mobile';\nimport axios from 'axios';\nimport { apiHost } from 'config';\n\nclass PartyContainer extends Component {\n\n    state = {currentSong: null};\n\n    getCurrentSong = () => {\n        if(!party || !party.host) return;\n\n        const token = party.host.token;\n        axios.get(\"https://api.spotify.com/v1/me/player/currently-playing\", {\n            headers: {\n                'Authorization': 'Bearer ' + token\n            }\n        }).then(response => {\n            const song = response.data.item;\n\n            if(!song) return;\n\n            if(currentSong && song) console.log(currentSong.id === song.id) \n\n            song && (!currentSong || song.id !== currentSong.id) && changeCurrentSong(song);\n        })\n    }\n\n    changeCurrentSong = song => {\n        localStorage.setItem('song', JSON.stringify(song));\n        setCS(song);\n\n        axios.post(`${apiHost}/api/songs/current?partyId=${party.id}`, {\n            artist: song.artists && song.artists[0] && song.artists[0].name,\n            imageURI: song.album && song.album.images && song.album.images[0] && song.album.images[0].url.\n            song && song.name\n        });\n    }\n\n    componentDidMount() {\n        if(member.id !== party.host.id) return;\n        setInterval(getCurrentSong, 2000);\n    }\n      \n    render() {\n        const { currentSong } = this.state;\n        return(\n            <div>\n                <Mobile party={{...party, currentSong}} />\n            </div>\n        )\n    }\n}\n \nexport default PartyContainer;"]},"metadata":{},"sourceType":"module"}